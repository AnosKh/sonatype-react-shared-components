/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import React from 'react';

import { GalleryDescriptionTile, GalleryExampleTile } from '../../gallery-components/GalleryTiles';
import NxVulnerabilityDetailsExample from './NxVulnerabilityDetailsExample';
import NxVulnerabilityDetailsThirdPartyScanExample from './NxVulnerabilityDetailsThirdPartyScanExample';

const exampleSourceCode = require('!!raw-loader!./NxVulnerabilityDetailsExample').default;
const vulnerabilityDetailsJson = require('../../resources/vulnerabilities/vulnerabilityDetailsJson.json');
const exampleSourceForThirdPartyScans = require('!!raw-loader!./NxVulnerabilityDetailsThirdPartyScanExample').default;
const thirdPartyScanVulnerabilityJson =
  require('../../resources/vulnerabilities/thirdPartyScanVulnerabilityDetails.json');

const NxVulnerabilityDetailsPage = () => {
  const serializedVulnDetailsJson = JSON.stringify(vulnerabilityDetailsJson, null, 2),
      serializedThirdPartyVulnJson = JSON.stringify(thirdPartyScanVulnerabilityJson, null, 2);

  return (
    <>
      <GalleryDescriptionTile>
        <p>Renders vulnerability details from vulnerabilityDetails JSON</p>
        <p>Props:</p>
        <table className="nx-table nx-table--gallery-props">
          <thead>
            <tr className="nx-table-row">
              <th className="nx-cell nx-cell--header">Prop</th>
              <th className="nx-cell nx-cell--header">Type</th>
              <th className="nx-cell nx-cell--header">Required</th>
              <th className="nx-cell nx-cell--header">Details</th>
            </tr>
          </thead>
          <tbody>
            <tr className="nx-table-row">
              <td className="nx-cell">vulnerabilityDetails</td>
              <td className="nx-cell">Object</td>
              <td className="nx-cell">Yes</td>
              <td className="nx-cell">
                see <code className="nx-code">VulnerabilityDetails</code> interface
                and <code className="nx-code">vulnerabilityDetailsJson</code> example below
              </td>
            </tr>
          </tbody>
        </table>
        <p>
          VulnerabilityDetails PropType can be imported separately
          as <code className="nx-code">vulnerabilityDetailsPropType</code>.
        </p>
        <p>
          Note that markdown fields in <code className="nx-code">vulnerabilityDetails</code> JSON are expected to use{' '}
          <a className="nx-text-link"
             target="_blank"
             rel="noreferrer"
             href="https://spec.commonmark.org/">
            CommonMark
          </a> flavored markdown.
          <br/>Also, in addition to CommonMark spec, a "soft break" is supported: a new line within a paragraph will be
          converted to <code className="nx-code">&lt;br&gt;</code> tag.
        </p>
      </GalleryDescriptionTile>
      <GalleryExampleTile title="Vulnerability Example" codeExamples={[exampleSourceCode, serializedVulnDetailsJson]}>
        <NxVulnerabilityDetailsExample />
      </GalleryExampleTile>
      <GalleryExampleTile title="Representative example of vulnerability data from third party scans"
                   codeExamples={[exampleSourceForThirdPartyScans, serializedThirdPartyVulnJson]}>
        <NxVulnerabilityDetailsThirdPartyScanExample/>
      </GalleryExampleTile>
    </>
  );
};

export default NxVulnerabilityDetailsPage;
