/**
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
@import '../../scss-shared/nx-variables';
@import '../../scss-shared/nx-container-helpers';
@import '../../scss-shared/nx-text-helpers';

.nx-vulnerability-details {
  $inline-margin: 4px;

  .nx-grid-col {
    @include container-vertical();
    overflow-x: hidden;
  }

  a {
    color: $nx-link-color;
    text-decoration: none;

    &:hover {
      color: $nx-link-color-hover;
    }
  }

  dl {
    margin: 0;

    dt {
      display: inline;
    }

    dd {
      display: inline;
      margin-left: 4px;
    }

    dd + dd {
      margin: 0;
      &::before {
        content: ', ';
      }
    }
  }

  .nx-vulnerability-details__section-label {
    @include bold();
    @include container-horizontal;

    display: block;

    color: $nx-color-blue-41;
    font-size: $nx-font-size-heading-level-4;
    line-height: 1.15;
    margin: 0;
    text-transform: uppercase;
  }

  .nx-vulnerability-details__pane {
    margin: 0 auto;
    max-width: 825px;
    padding: 0 $nx-spacing-md;
  }

  .nx-vulnerability-details__root-cause-path + .nx-vulnerability-details__root-cause-path {
    &::before {
      @include bold();

      content: '<=';
      margin: 0 $inline-margin 0 $inline-margin;
    }
  }

  .nx-vulnerability-details__root-cause-version-range {
    &::before {
      content: ':';
      margin: 0 $inline-margin 0 $inline-margin;
    }
  }

  .nx-vulnerability-details__section {
    @include container-vertical();

    margin-bottom: $nx-spacing-l;
  }

  .nx-vulnerability-details__malicious-code-warning {
    @include container-horizontal;
    color: $nx-invalid-color;
  }

  .nx-vulnerability-details__html-detail {
    @include container-vertical();

    margin-bottom: 14px;

    code {
      @extend %nx-code;
    }

    pre {
      background-color: $nx-grey-1;
      border: 1px solid rgba(0, 0, 0, 0.15);
      border-radius: 4px;
      font-size: 13px;
      margin: 0 0 10px;
      padding: 9.5px;
      white-space: pre-wrap;

      code {
        border: 0;
        color: inherit;
        padding: 0;
        white-space: pre-wrap;
      }
    }

    blockquote {
      border-left: 5px solid $nx-grey-2;
      margin: 0 0 20px;
      padding: 0 0 0 15px;
    }
  }
}

.nx-vulnerability-details__section-content {
  @include container-vertical();

  .nx-p {
    color: $nx-text-color-light;
  }
}
