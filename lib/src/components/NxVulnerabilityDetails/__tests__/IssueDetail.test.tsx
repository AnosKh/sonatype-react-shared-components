/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import React from 'react';
import { getShallowComponent } from '../../../__testutils__/enzymeUtils';

import IssueDetail, { Props } from '../details/IssueDetail';
import DetailLink from '../details/DetailLink';
import RenderDetail from '../details/RenderDetail';

describe('IssueDetail', function() {
  const props: Props = {
    identifier: 'TEST_VULN_ID'
  };
  const getShallow = getShallowComponent<Props>(IssueDetail, props);

  it('renders identifier text if vulnerabilityLink is not provided', function () {
    expect(getShallow()).toContainReact(<RenderDetail title="Issue">TEST_VULN_ID</RenderDetail>);
  });

  it('renders DetailLink if vulnerabilityLink is provided', function() {
    const shallowRender = getShallow({
      vulnerabilityLink: 'https://nvd.nist.gov/vuln/detail/CVE-2014-0114'
    });

    expect(shallowRender).toContainReact(
      <RenderDetail title="Issue">
        <DetailLink href="https://nvd.nist.gov/vuln/detail/CVE-2014-0114">TEST_VULN_ID</DetailLink>
      </RenderDetail>
    );
  });
});
