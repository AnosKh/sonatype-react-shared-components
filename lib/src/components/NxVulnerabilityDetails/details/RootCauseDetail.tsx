/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
/* eslint react/prop-types: 0 */
import React, {FunctionComponent, ReactNode} from 'react';
import {join} from 'ramda';

import {RootCause} from '../types';
import RenderDetail from './RenderDetail';

export interface Props {
  rootCauses?: RootCause[] | null;
}

function renderRootCause(rootCause: RootCause): ReactNode {
  const paths = rootCause.listOfPaths.map(path =>
    <span key={path} className="nx-vulnerability-details__root-cause-path">{path}</span>);

  return (
    <div key={join('', rootCause.listOfPaths)}>
      {paths}<span className="nx-vulnerability-details__root-cause-version-range">{rootCause.versionRange}</span>
    </div>
  );
}

const RootCauseDetail: FunctionComponent<Props> = function RootCauseDetail({rootCauses}) {
  return rootCauses ? (
    <RenderDetail title="Root Cause">
      {rootCauses.map(renderRootCause)}
    </RenderDetail>
  ) : null;
};

export default RootCauseDetail;
